<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Google Account Settings</title>

  <link rel="stylesheet" href="css/main.css">
  <script src="js/fa.js"></script>
  <script>window.$ = window.jQuery = require('jquery');</script>
</head>

<body>
  <div class="page" style="border-radius: 6px;">
    <div class="header" style="background: transparent; padding-top: 1rem; -webkit-app-region: drag">
      <div></div>
      <div></div>
      <div class="window-buttons" style="-webkit-app-region: no-drag;">
        <a id="minimize"><i class="fas fa-fw fa-compress-alt"></i></a>
        <a id="close"><i class="fas fa-fw fa-times"></i></a>
      </div>
    </div>

    <div style="display: flex; align-items: center; justify-content: center; flex: 1; overflow-y: hidden;">
      <div class="box f-col flex-col" style="width: 20rem; margin-bottom: 2rem;">
        <div class="h3" style="text-align: center; margin-top: 0;" id="googleAccountName">Google Account</div>
        <div class="f-group">
          <div class="f-label">Name</div>
          <input id="name" type="text" class="f-input" placeholder="Account Name">
        </div>
        <div class="f-group">
          <div class="f-label">Proxy</div>
          <input id="proxy" type="text" class="f-input" placeholder="ip:port:user:pass">
        </div>
        <div class="f-group">
          <div class="f-label">Site</div>
          <select id="site" class="f-select">
            <option selected value="https://www.supremenewyork.com/mobile/">Supreme</option>
            <option value="https://register.supremenewyork.com">Supreme (Instore)</option>
          </select>
        </div>
        <a id="save" href="#" class="btn btn-primary">Save</a>
        <a id="login" href="#" class="btn">Login</a>
        <a id="open" href="#" class="btn">Open Solver</a>
      </div>
    </div>
  </div>
  <script>
    const { ipcRenderer, remote } = require('electron');

    // get info from main
    ipcRenderer.send('getAccountInfo');
    ipcRenderer.on('receivedAccountInfo', (e, data) => {
      window.data = {...data};
      document.querySelector('#name').value = window.data.name;
      document.querySelector('#googleAccountName').innerHTML = window.data.name;
      document.querySelector('title').innerText = window.data.name;
      document.querySelector('#proxy').value = window.data.proxy;
      
    });

    document.querySelector('#save').addEventListener('click', () => {
      let name = document.querySelector('#name').value;
      window.data.proxy = document.querySelector('#proxy').value;
      window.data.name = !!name ? name : window.data.name;
      ipcRenderer.send('updateAccountInfo', { ...window.data });
    });

    document.querySelector('#login').addEventListener('click', () => {
      ipcRenderer.send('loginAccount');
    });

    document.querySelector('#open').addEventListener('click', () => {
      window.data.site = document.querySelector('#site').value;
      ipcRenderer.send('openSolver', { ...window.data });
    });

    document.querySelector('#minimize').addEventListener('click', () => {
      remote.getCurrentWindow().minimize();
    });

    document.querySelector('#close').addEventListener('click', () => {
      remote.getCurrentWindow().close();
    });
  </script>
</body>

</html>